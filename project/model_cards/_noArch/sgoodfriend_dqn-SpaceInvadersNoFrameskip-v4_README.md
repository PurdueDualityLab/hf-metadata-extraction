---
library_name: rl-algo-impls
tags:
- SpaceInvadersNoFrameskip-v4
- dqn
- deep-reinforcement-learning
- reinforcement-learning
model-index:
- name: dqn
  results:
  - metrics:
    - type: mean_reward
      value: 1389.69 +/- 264.19
      name: mean_reward
    task:
      type: reinforcement-learning
      name: reinforcement-learning
    dataset:
      name: SpaceInvadersNoFrameskip-v4
      type: SpaceInvadersNoFrameskip-v4
---
# **DQN** Agent playing **SpaceInvadersNoFrameskip-v4**

This is a trained model of a **DQN** agent playing **SpaceInvadersNoFrameskip-v4** using the [/sgoodfriend/rl-algo-impls](https://github.com/sgoodfriend/rl-algo-impls) repo.

All models trained at this commit can be found at https://api.wandb.ai/links/sgoodfriend/ysd5gj7p.

## Training Results

This model was trained from 3 trainings of **DQN** agents using different initial seeds. These agents were trained by checking out [983cb75](https://github.com/sgoodfriend/rl-algo-impls/tree/983cb75e43e51cf4ef57f177194ab9a4a1a8808b). The best and last models were kept from each training. This submission has loaded the best models from each training, reevaluates them, and selects the best model from these latest evaluations (mean - std).

| algo   | env                         |   seed |   reward_mean |   reward_std |   eval_episodes | best   | wandb_url                                                                    |
|:-------|:----------------------------|-------:|--------------:|-------------:|----------------:|:-------|:-----------------------------------------------------------------------------|
| dqn    | SpaceInvadersNoFrameskip-v4 |      1 |      1191.56  |      203.989 |              16 |        | [wandb](https://wandb.ai/sgoodfriend/rl-algo-impls-benchmarks/runs/3b09u4kc) |
| dqn    | SpaceInvadersNoFrameskip-v4 |      2 |       954.688 |      382.894 |              16 |        | [wandb](https://wandb.ai/sgoodfriend/rl-algo-impls-benchmarks/runs/dwj76umg) |
| dqn    | SpaceInvadersNoFrameskip-v4 |      3 |      1389.69  |      264.194 |              16 | *      | [wandb](https://wandb.ai/sgoodfriend/rl-algo-impls-benchmarks/runs/ixf6w9pu) |


### Prerequisites: Weights & Biases (WandB)
Training and benchmarking assumes you have a Weights & Biases project to upload runs to.
By default training goes to a rl-algo-impls project while benchmarks go to
rl-algo-impls-benchmarks. During training and benchmarking runs, videos of the best
models and the model weights are uploaded to WandB.

Before doing anything below, you'll need to create a wandb account and run `wandb
login`.



## Usage
/sgoodfriend/rl-algo-impls: https://github.com/sgoodfriend/rl-algo-impls

Note: While the model state dictionary and hyperaparameters are saved, the latest
implementation could be sufficiently different to not be able to reproduce similar
results. You might need to checkout the commit the agent was trained on:
[983cb75](https://github.com/sgoodfriend/rl-algo-impls/tree/983cb75e43e51cf4ef57f177194ab9a4a1a8808b).
```
# Downloads the model, sets hyperparameters, and runs agent for 3 episodes
python enjoy.py --wandb-run-path=sgoodfriend/rl-algo-impls-benchmarks/ixf6w9pu
```

Setup hasn't been completely worked out yet, so you might be best served by using Google
Colab starting from the
[colab_enjoy.ipynb](https://github.com/sgoodfriend/rl-algo-impls/blob/main/colab_enjoy.ipynb)
notebook.



## Training
If you want the highest chance to reproduce these results, you'll want to checkout the
commit the agent was trained on: [983cb75](https://github.com/sgoodfriend/rl-algo-impls/tree/983cb75e43e51cf4ef57f177194ab9a4a1a8808b). While
training is deterministic, different hardware will give different results.

```
python train.py --algo dqn --env SpaceInvadersNoFrameskip-v4 --seed 3
```

Setup hasn't been completely worked out yet, so you might be best served by using Google
Colab starting from the
[colab_train.ipynb](https://github.com/sgoodfriend/rl-algo-impls/blob/main/colab_train.ipynb)
notebook.



## Benchmarking (with Lambda Labs instance)
This and other models from https://api.wandb.ai/links/sgoodfriend/ysd5gj7p were generated by running a script on a Lambda
Labs instance. In a Lambda Labs instance terminal:
```
git clone git@github.com:sgoodfriend/rl-algo-impls.git
cd rl-algo-impls
bash ./lambda_labs/setup.sh
wandb login
bash ./lambda_labs/benchmark.sh [-a {"ppo a2c dqn vpg"}] [-e ENVS] [-j {6}] [-p {rl-algo-impls-benchmarks}] [-s {"1 2 3"}]
```

### Alternative: Google Colab Pro+
As an alternative,
[colab_benchmark.ipynb](https://github.com/sgoodfriend/rl-algo-impls/tree/main/benchmarks#:~:text=colab_benchmark.ipynb),
can be used. However, this requires a Google Colab Pro+ subscription and running across
4 separate instances because otherwise running all jobs will exceed the 24-hour limit.



## Hyperparameters
This isn't exactly the format of hyperparams in hyperparams/dqn.yml, but instead the Wandb Run Config. However, it's very
close and has some additional data:
```
additional_keys_to_log: []
algo: dqn
algo_hyperparams:
  batch_size: 32
  buffer_size: 100000
  exploration_final_eps: 0.01
  exploration_fraction: 0.1
  gradient_steps: 2
  learning_rate: 0.0001
  learning_starts: 100000
  target_update_interval: 1000
  train_freq: 8
device: auto
env: SpaceInvadersNoFrameskip-v4
env_hyperparams:
  frame_stack: 4
  n_envs: 8
  no_reward_fire_steps: 500
  no_reward_timeout_steps: 1000
  vec_env_class: async
env_id: null
eval_hyperparams:
  deterministic: false
microrts_reward_decay_callback: false
n_timesteps: 10000000
policy_hyperparams: {}
seed: 3
use_deterministic_algorithms: true
wandb_entity: null
wandb_group: null
wandb_project_name: rl-algo-impls-benchmarks
wandb_tags:
- benchmark_983cb75
- host_129-159-43-75
- branch_main
- v0.0.9

```
