---
library_name: rl-algo-impls
tags:
- LunarLander-v2
- ppo
- deep-reinforcement-learning
- reinforcement-learning
model-index:
- name: ppo
  results:
  - metrics:
    - type: mean_reward
      value: 282.5 +/- 18.89
      name: mean_reward
    task:
      type: reinforcement-learning
      name: reinforcement-learning
    dataset:
      name: LunarLander-v2
      type: LunarLander-v2
---
# **PPO** Agent playing **LunarLander-v2**

This is a trained model of a **PPO** agent playing **LunarLander-v2** using the [/sgoodfriend/rl-algo-impls](https://github.com/sgoodfriend/rl-algo-impls) repo.

All models trained at this commit can be found at https://api.wandb.ai/links/sgoodfriend/ysd5gj7p.

## Training Results

This model was trained from 3 trainings of **PPO** agents using different initial seeds. These agents were trained by checking out [983cb75](https://github.com/sgoodfriend/rl-algo-impls/tree/983cb75e43e51cf4ef57f177194ab9a4a1a8808b). The best and last models were kept from each training. This submission has loaded the best models from each training, reevaluates them, and selects the best model from these latest evaluations (mean - std).

| algo   | env            |   seed |   reward_mean |   reward_std |   eval_episodes | best   | wandb_url                                                                    |
|:-------|:---------------|-------:|--------------:|-------------:|----------------:|:-------|:-----------------------------------------------------------------------------|
| ppo    | LunarLander-v2 |      1 |       268.787 |      20.2813 |              16 |        | [wandb](https://wandb.ai/sgoodfriend/rl-algo-impls-benchmarks/runs/v47s1jxh) |
| ppo    | LunarLander-v2 |      2 |       282.498 |      18.894  |              16 | *      | [wandb](https://wandb.ai/sgoodfriend/rl-algo-impls-benchmarks/runs/k0mzfu9d) |
| ppo    | LunarLander-v2 |      3 |       276.126 |      22.1541 |              16 |        | [wandb](https://wandb.ai/sgoodfriend/rl-algo-impls-benchmarks/runs/2pmkba21) |


### Prerequisites: Weights & Biases (WandB)
Training and benchmarking assumes you have a Weights & Biases project to upload runs to.
By default training goes to a rl-algo-impls project while benchmarks go to
rl-algo-impls-benchmarks. During training and benchmarking runs, videos of the best
models and the model weights are uploaded to WandB.

Before doing anything below, you'll need to create a wandb account and run `wandb
login`.



## Usage
/sgoodfriend/rl-algo-impls: https://github.com/sgoodfriend/rl-algo-impls

Note: While the model state dictionary and hyperaparameters are saved, the latest
implementation could be sufficiently different to not be able to reproduce similar
results. You might need to checkout the commit the agent was trained on:
[983cb75](https://github.com/sgoodfriend/rl-algo-impls/tree/983cb75e43e51cf4ef57f177194ab9a4a1a8808b).
```
# Downloads the model, sets hyperparameters, and runs agent for 3 episodes
python enjoy.py --wandb-run-path=sgoodfriend/rl-algo-impls-benchmarks/k0mzfu9d
```

Setup hasn't been completely worked out yet, so you might be best served by using Google
Colab starting from the
[colab_enjoy.ipynb](https://github.com/sgoodfriend/rl-algo-impls/blob/main/colab_enjoy.ipynb)
notebook.



## Training
If you want the highest chance to reproduce these results, you'll want to checkout the
commit the agent was trained on: [983cb75](https://github.com/sgoodfriend/rl-algo-impls/tree/983cb75e43e51cf4ef57f177194ab9a4a1a8808b). While
training is deterministic, different hardware will give different results.

```
python train.py --algo ppo --env LunarLander-v2 --seed 2
```

Setup hasn't been completely worked out yet, so you might be best served by using Google
Colab starting from the
[colab_train.ipynb](https://github.com/sgoodfriend/rl-algo-impls/blob/main/colab_train.ipynb)
notebook.



## Benchmarking (with Lambda Labs instance)
This and other models from https://api.wandb.ai/links/sgoodfriend/ysd5gj7p were generated by running a script on a Lambda
Labs instance. In a Lambda Labs instance terminal:
```
git clone git@github.com:sgoodfriend/rl-algo-impls.git
cd rl-algo-impls
bash ./lambda_labs/setup.sh
wandb login
bash ./lambda_labs/benchmark.sh [-a {"ppo a2c dqn vpg"}] [-e ENVS] [-j {6}] [-p {rl-algo-impls-benchmarks}] [-s {"1 2 3"}]
```

### Alternative: Google Colab Pro+
As an alternative,
[colab_benchmark.ipynb](https://github.com/sgoodfriend/rl-algo-impls/tree/main/benchmarks#:~:text=colab_benchmark.ipynb),
can be used. However, this requires a Google Colab Pro+ subscription and running across
4 separate instances because otherwise running all jobs will exceed the 24-hour limit.



## Hyperparameters
This isn't exactly the format of hyperparams in hyperparams/ppo.yml, but instead the Wandb Run Config. However, it's very
close and has some additional data:
```
additional_keys_to_log: []
algo: ppo
algo_hyperparams:
  batch_size: 64
  clip_range: 0.2
  clip_range_decay: linear
  ent_coef: 0.01
  gae_lambda: 0.98
  gamma: 0.999
  learning_rate: 0.0005
  learning_rate_decay: linear
  n_epochs: 4
  n_steps: 1024
  normalize_advantage: false
device: auto
env: LunarLander-v2
env_hyperparams:
  n_envs: 16
env_id: null
eval_hyperparams: {}
microrts_reward_decay_callback: false
n_timesteps: 4000000
policy_hyperparams: {}
seed: 2
use_deterministic_algorithms: true
wandb_entity: null
wandb_group: null
wandb_project_name: rl-algo-impls-benchmarks
wandb_tags:
- benchmark_983cb75
- host_129-159-43-75
- branch_main
- v0.0.9

```
