---
tags:
- espnet
- audio
- audio-to-audio
language: noinfo
datasets:
- clarity
license: cc-by-4.0
---

## ESPnet2 ENH model 

### `popcornell/clarity21_train_enh_beamformer_mvdr`

This model was trained by popcornell using clarity recipe in [espnet](https://github.com/espnet/espnet/).

### Demo: How to use in ESPnet2

```bash
cd espnet

pip install -e .
cd egs2/clarity/enh_2021
./run.sh --skip_data_prep false --skip_train true --download_model popcornell/clarity21_train_enh_beamformer_mvdr
```

<!-- Generated by ./scripts/utils/show_enh_score.sh -->
# RESULTS
## Environments
- date: `Tue Apr 12 20:54:54 UTC 2022`
- python version: `3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0]`
- espnet version: `espnet 0.10.5a1`
- pytorch version: `pytorch 1.10.1`
- Git hash: `46eaa5eb6bea11cc33927392dca7888921491d8c`
  - Commit date: `Sat Mar 26 22:35:44 2022 +0100`


## ..

config: conf/tuning/train_enh_beamformer_mvdr.yaml

|dataset|STOI|SAR|SDR|SIR|
|---|---|---|---|---|
|enhanced_dev|0.96|13.02|13.02|0.00|

## ENH config

<details><summary>expand</summary>

```
config: conf/tuning/train_enh_beamformer_mvdr.yaml
print_config: false
log_level: INFO
dry_run: false
iterator_type: sequence
output_dir: exp/enh_train_enh_beamformer_mvdr_raw
ngpu: 1
seed: 0
num_workers: 4
num_att_plot: 3
dist_backend: nccl
dist_init_method: env://
dist_world_size: null
dist_rank: null
local_rank: 0
dist_master_addr: null
dist_master_port: null
dist_launcher: null
multiprocessing_distributed: false
unused_parameters: false
sharded_ddp: false
cudnn_enabled: true
cudnn_benchmark: false
cudnn_deterministic: true
collect_stats: false
write_collected_feats: false
max_epoch: 8
patience: 4
val_scheduler_criterion:
- valid
- loss
early_stopping_criterion:
- valid
- loss
- min
best_model_criterion:
-   - valid
    - si_snr
    - max
-   - valid
    - loss
    - min
keep_nbest_models: 1
nbest_averaging_interval: 0
grad_clip: 5.0
grad_clip_type: 2.0
grad_noise: false
accum_grad: 1
no_forward_run: false
resume: true
train_dtype: float32
use_amp: false
log_interval: null
use_matplotlib: true
use_tensorboard: true
use_wandb: false
wandb_project: null
wandb_id: null
wandb_entity: null
wandb_name: null
wandb_model_log_interval: -1
detect_anomaly: false
pretrain_path: null
init_param: []
ignore_init_mismatch: false
freeze_param: []
num_iters_per_epoch: null
batch_size: 1
valid_batch_size: null
batch_bins: 1000000
valid_batch_bins: null
train_shape_file:
- exp/enh_stats_16000/train/speech_mix_shape
- exp/enh_stats_16000/train/speech_ref1_shape
- exp/enh_stats_16000/train/noise_ref1_shape
valid_shape_file:
- exp/enh_stats_16000/valid/speech_mix_shape
- exp/enh_stats_16000/valid/speech_ref1_shape
- exp/enh_stats_16000/valid/noise_ref1_shape
batch_type: folded
valid_batch_type: null
fold_length:
- 80000
- 80000
- 80000
sort_in_batch: descending
sort_batch: descending
multiple_iterator: false
chunk_length: 500
chunk_shift_ratio: 0.5
num_cache_chunks: 1024
train_data_path_and_name_and_type:
-   - dump/raw/train/wav.scp
    - speech_mix
    - sound
-   - dump/raw/train/spk1.scp
    - speech_ref1
    - sound
-   - dump/raw/train/noise1.scp
    - noise_ref1
    - sound
valid_data_path_and_name_and_type:
-   - dump/raw/dev/wav.scp
    - speech_mix
    - sound
-   - dump/raw/dev/spk1.scp
    - speech_ref1
    - sound
-   - dump/raw/dev/noise1.scp
    - noise_ref1
    - sound
allow_variable_data_keys: false
max_cache_size: 0.0
max_cache_fd: 32
valid_max_cache_size: null
optim: adam
optim_conf:
    lr: 0.001
    eps: 1.0e-08
    weight_decay: 0
scheduler: reducelronplateau
scheduler_conf:
    mode: min
    factor: 0.5
    patience: 1
init: xavier_uniform
model_conf:
    stft_consistency: false
    loss_type: mask_mse
    mask_type: null
criterions:
-   name: snr
    conf:
        eps: 1e-8
    wrapper: fixed_order
    wrapper_conf:
        weight: 1.0
use_preprocessor: false
encoder: stft
encoder_conf:
    n_fft: 1024
    hop_length: 512
    use_builtin_complex: false
separator: wpe_beamformer
separator_conf:
    num_spk: 1
    loss_type: spectrum
    use_wpe: false
    use_beamformer: true
    bnet_type: blstmp
    blayers: 3
    bunits: 300
    bprojs: 320
    badim: 320
    ref_channel: 0
    use_noise_mask: true
    bnonlinear: sigmoid
    beamformer_type: mvdr_souden
    rtf_iterations: 2
    bdropout_rate: 0.0
    shared_power: true
    diagonal_loading: false
    diag_eps_wpe: 1e-4
    diag_eps_bf: 1e-4
    mask_flooring: false
    flooring_thres_wpe: 1e-6
    flooring_thres_bf: 1e-6
    use_torch_solver: true
decoder: stft
decoder_conf:
    n_fft: 1024
    hop_length: 512
required:
- output_dir
version: 0.10.5a1
distributed: false
```

</details>



### Citing ESPnet

```BibTex
@inproceedings{watanabe2018espnet,
  author={Shinji Watanabe and Takaaki Hori and Shigeki Karita and Tomoki Hayashi and Jiro Nishitoba and Yuya Unno and Nelson Yalta and Jahn Heymann and Matthew Wiesner and Nanxin Chen and Adithya Renduchintala and Tsubasa Ochiai},
  title={{ESPnet}: End-to-End Speech Processing Toolkit},
  year={2018},
  booktitle={Proceedings of Interspeech},
  pages={2207--2211},
  doi={10.21437/Interspeech.2018-1456},
  url={http://dx.doi.org/10.21437/Interspeech.2018-1456}
}


@inproceedings{ESPnet-SE,
  author = {Chenda Li and Jing Shi and Wangyou Zhang and Aswin Shanmugam Subramanian and Xuankai Chang and 
  Naoyuki Kamo and Moto Hira and Tomoki Hayashi and Christoph B{"{o}}ddeker and Zhuo Chen and Shinji Watanabe},
  title = {ESPnet-SE: End-To-End Speech Enhancement and Separation Toolkit Designed for {ASR} Integration},
  booktitle = {{IEEE} Spoken Language Technology Workshop, {SLT} 2021, Shenzhen, China, January 19-22, 2021},
  pages = {785--792},
  publisher = {{IEEE}},
  year = {2021},
  url = {https://doi.org/10.1109/SLT48900.2021.9383615},
  doi = {10.1109/SLT48900.2021.9383615},
  timestamp = {Mon, 12 Apr 2021 17:08:59 +0200},
  biburl = {https://dblp.org/rec/conf/slt/Li0ZSCKHHBC021.bib},
  bibsource = {dblp computer science bibliography, https://dblp.org}
}


```

or arXiv:

```bibtex
@misc{watanabe2018espnet,
  title={ESPnet: End-to-End Speech Processing Toolkit}, 
  author={Shinji Watanabe and Takaaki Hori and Shigeki Karita and Tomoki Hayashi and Jiro Nishitoba and Yuya Unno and Nelson Yalta and Jahn Heymann and Matthew Wiesner and Nanxin Chen and Adithya Renduchintala and Tsubasa Ochiai},
  year={2018},
  eprint={1804.00015},
  archivePrefix={arXiv},
  primaryClass={cs.CL}
}
```
